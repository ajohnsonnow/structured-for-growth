<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Offline — Structured for Growth</title>
  <meta name="description" content="You are currently offline. Some cached pages from Structured for Growth may still be available on your device.">
  <link rel="canonical" href="https://structuredforgrowth.com/offline">
  <!-- Open Graph / Social -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Offline — Structured for Growth">
  <meta property="og:description" content="Offline fallback page for Structured for Growth.">
  <meta property="og:url" content="https://structuredforgrowth.com/offline">
  <meta name="twitter:card" content="summary">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f8fafc;
      color: #1e293b;
      padding: 2rem;
    }
    .offline-container {
      text-align: center;
      max-width: 480px;
    }
    .offline-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      line-height: 1;
    }
    .offline-icon svg {
      width: 96px;
      height: 96px;
      stroke: #94a3b8;
    }
    h1 {
      font-size: 1.875rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: #0f172a;
    }
    p {
      font-size: 1.125rem;
      color: #64748b;
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }
    .cached-pages {
      text-align: left;
      margin: 1.5rem 0;
      padding: 1rem;
      background: #fff;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
    }
    .cached-pages h2 {
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #475569;
      margin-bottom: 0.75rem;
    }
    .cached-pages ul {
      list-style: none;
      padding: 0;
    }
    .cached-pages li {
      padding: 0.375rem 0;
    }
    .cached-pages a {
      color: #2563eb;
      text-decoration: none;
      font-weight: 500;
    }
    .cached-pages a:hover { text-decoration: underline; }
    .retry-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: #2563eb;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      min-height: 44px;
      min-width: 44px;
      transition: background 0.2s;
    }
    .retry-btn:hover { background: #1d4ed8; }
    .retry-btn:focus-visible {
      outline: 3px solid #2563eb;
      outline-offset: 2px;
    }
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ef4444;
      display: inline-block;
    }
    .status-text { font-size: 0.875rem; color: #94a3b8; margin-top: 1rem; }
    .skip-link {
      position: absolute;
      left: -9999px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>
  <main id="main-content" class="offline-container" role="main">
    <div class="offline-icon" aria-hidden="true">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
      </svg>
    </div>

    <h1>You're Offline</h1>
    <p>
      It looks like your internet connection dropped.
      Some pages may still be available from your device's cache.
    </p>

    <div class="cached-pages" id="cachedPages" hidden>
      <h2>Available Offline</h2>
      <ul id="cachedList"></ul>
    </div>

    <button class="retry-btn" onclick="location.reload()" aria-label="Retry connection">
      Retry Connection
    </button>

    <p class="status-text">
      <span class="status-dot" id="statusDot" aria-hidden="true"></span>
      <span id="statusText">No internet connection</span>
    </p>
  </main>

  <script>
    // Check which pages are cached and show them
    if ('caches' in window) {
      caches.keys().then(keys => {
        const pageNames = {
          '/': 'Home',
          '/index.html': 'Home',
          '/dashboard.html': 'Dashboard',
          '/templates.html': 'Templates',
          '/compliance.html': 'Compliance',
          '/portal.html': 'Client Portal',
          '/docs.html': 'Documentation',
          '/mbai.html': 'MBAi',
        };

        Promise.all(keys.map(k => caches.open(k).then(c => c.keys())))
          .then(requestArrays => {
            const allUrls = requestArrays.flat().map(r => new URL(r.url).pathname);
            const htmlPages = [...new Set(allUrls.filter(u => u.endsWith('.html') || u === '/'))];
            const list = document.getElementById('cachedList');
            const container = document.getElementById('cachedPages');

            if (htmlPages.length > 0) {
              container.hidden = false;
              for (const page of htmlPages) {
                const name = pageNames[page] || page;
                const li = document.createElement('li');
                li.innerHTML = `<a href="${page}">${name}</a>`;
                list.appendChild(li);
              }
            }
          });
      });
    }

    // Monitor for reconnection
    window.addEventListener('online', () => {
      document.getElementById('statusDot').style.background = '#22c55e';
      document.getElementById('statusText').textContent = 'Back online! Reloading...';
      setTimeout(() => location.reload(), 1500);
    });
  </script>
</body>
</html>
