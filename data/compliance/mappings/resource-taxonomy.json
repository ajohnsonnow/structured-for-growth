{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "title": "Resource Taxonomy",
  "description": "Defines the resource types commonly used in automated evidence collection and compliance-as-code evaluation. Each resource type maps to compliance controls it can help satisfy.",
  "version": "1.0.0",
  "resources": [
    {
      "type": "UserAccount",
      "description": "Represents a user identity within an organization's systems. Used for access control evaluation, authentication verification, and accountability tracking.",
      "evaluationLogic": "Check for MFA enrollment, role assignments, password policy compliance, last login date, and account status (active/disabled). Flag shared or orphaned accounts.",
      "applicableFrameworks": {
        "soc2": ["CC6.1", "CC6.2", "CC6.3"],
        "iso27001": ["A.5.15", "A.5.16", "A.5.17", "A.8.5"],
        "hipaa": ["TS-AC-1", "TS-PE-1"],
        "gdpr": ["GDPR-32b"],
        "pci-dss": ["PCI-7", "PCI-8"],
        "nis2": ["NIS2-21.2i", "NIS2-21.2j"],
        "cmmc": ["AC.L2-3.1.1", "IA.L2-3.5.1", "IA.L2-3.5.3"]
      },
      "properties": [
        { "name": "userId", "type": "string", "description": "Unique user identifier", "required": true },
        { "name": "email", "type": "string", "description": "User email address", "required": true },
        { "name": "mfaEnabled", "type": "boolean", "description": "Whether MFA is enabled for the account", "required": true },
        { "name": "mfaMethod", "type": "string", "description": "MFA method used (TOTP, FIDO2, SMS, etc.)", "required": false },
        { "name": "roles", "type": "array", "description": "List of assigned roles", "required": true },
        { "name": "privileged", "type": "boolean", "description": "Whether the account has administrative/privileged access", "required": true },
        { "name": "lastLogin", "type": "string", "description": "ISO 8601 timestamp of last successful login", "required": true },
        { "name": "accountStatus", "type": "string", "description": "active, disabled, locked, or suspended", "required": true },
        { "name": "passwordLastChanged", "type": "string", "description": "ISO 8601 timestamp of last password change", "required": true },
        { "name": "createdDate", "type": "string", "description": "Account creation date", "required": true },
        { "name": "department", "type": "string", "description": "Department or business unit", "required": false },
        { "name": "sharedAccount", "type": "boolean", "description": "Whether this is a shared/service account", "required": true }
      ],
      "complianceChecks": [
        { "check": "mfa_enabled", "rule": "mfaEnabled === true", "failMessage": "MFA not enabled-violates CC6.1, A.8.5, PCI Req 8, HIPAA TS-PE-1", "severity": "critical" },
        { "check": "no_shared_accounts", "rule": "sharedAccount === false", "failMessage": "Shared account detected-violates unique user identification requirements", "severity": "high" },
        { "check": "inactive_account", "rule": "daysSinceLastLogin < 90", "failMessage": "Account inactive >90 days-review for disablement", "severity": "medium" },
        { "check": "password_age", "rule": "daysSincePasswordChange < 365", "failMessage": "Password older than 1 year", "severity": "medium" },
        { "check": "privileged_mfa", "rule": "if privileged then mfaMethod in ['FIDO2', 'TOTP']", "failMessage": "Privileged account using weak MFA method", "severity": "critical" }
      ]
    },
    {
      "type": "UserComputer",
      "description": "Represents a computing endpoint (workstation, laptop, server) managed within the organization. Used for configuration compliance, patch status, and endpoint security evaluation.",
      "evaluationLogic": "Verify OS patch level, antimalware status, encryption status, firewall configuration, and hardening compliance against CIS benchmarks.",
      "applicableFrameworks": {
        "soc2": ["CC6.6", "CC6.8", "CC7.1"],
        "iso27001": ["A.8.1", "A.8.7", "A.8.9"],
        "hipaa": ["TS-TX-1"],
        "pci-dss": ["PCI-1", "PCI-2", "PCI-5"],
        "dora": ["DORA-7"],
        "nis2": ["NIS2-21.2g"],
        "cmmc": ["SC.L2-3.13.1"]
      },
      "properties": [
        { "name": "hostname", "type": "string", "description": "Computer hostname", "required": true },
        { "name": "operatingSystem", "type": "string", "description": "OS name and version", "required": true },
        { "name": "patchLevel", "type": "string", "description": "Current patch level or last update date", "required": true },
        { "name": "diskEncrypted", "type": "boolean", "description": "Whether full-disk encryption is enabled", "required": true },
        { "name": "antiMalwareStatus", "type": "string", "description": "active, disabled, or not_installed", "required": true },
        { "name": "antiMalwareLastUpdate", "type": "string", "description": "Last definition update date", "required": true },
        { "name": "firewallEnabled", "type": "boolean", "description": "Whether host-based firewall is enabled", "required": true },
        { "name": "cisComplianceScore", "type": "number", "description": "CIS Benchmark compliance score (0-100)", "required": false },
        { "name": "lastSeenOnline", "type": "string", "description": "Last heartbeat timestamp", "required": true },
        { "name": "assignedUser", "type": "string", "description": "User the device is assigned to", "required": false },
        { "name": "classification", "type": "string", "description": "Device classification: workstation, laptop, server, mobile", "required": true }
      ],
      "complianceChecks": [
        { "check": "disk_encryption", "rule": "diskEncrypted === true", "failMessage": "Full-disk encryption not enabled-data at rest protection failure", "severity": "critical" },
        { "check": "antimalware_active", "rule": "antiMalwareStatus === 'active'", "failMessage": "Antimalware not active-violates PCI Req 5, A.8.7", "severity": "critical" },
        { "check": "firewall_enabled", "rule": "firewallEnabled === true", "failMessage": "Host firewall disabled-violates PCI Req 1", "severity": "high" },
        { "check": "patch_current", "rule": "daysSinceLastPatch < 30", "failMessage": "Critical patches older than 30 days", "severity": "high" },
        { "check": "cis_compliance", "rule": "cisComplianceScore >= 80", "failMessage": "CIS benchmark score below 80%", "severity": "medium" }
      ]
    },
    {
      "type": "Secret",
      "description": "Represents a cryptographic secret, API key, certificate, or password stored in an organization's systems. Used for key management, rotation, and secure storage evaluation.",
      "evaluationLogic": "Verify encryption algorithm strength, key rotation compliance, storage in approved vault, expiration status, and access restrictions.",
      "applicableFrameworks": {
        "soc2": ["CC6.7", "C1.1"],
        "iso27001": ["A.8.24"],
        "hipaa": ["TS-AC-4", "TS-TX-2"],
        "gdpr": ["GDPR-32a"],
        "pci-dss": ["PCI-3", "PCI-4"],
        "nis2": ["NIS2-21.2h"],
        "cmmc": ["SC.L2-3.13.11", "IA.L2-3.5.10"]
      },
      "properties": [
        { "name": "secretId", "type": "string", "description": "Unique identifier for the secret", "required": true },
        { "name": "secretType", "type": "string", "description": "Type: api_key, certificate, password, encryption_key, ssh_key, token", "required": true },
        { "name": "algorithm", "type": "string", "description": "Encryption/hashing algorithm used", "required": true },
        { "name": "keyLength", "type": "number", "description": "Key length in bits", "required": true },
        { "name": "storedInVault", "type": "boolean", "description": "Whether stored in an approved secrets manager/vault", "required": true },
        { "name": "vaultName", "type": "string", "description": "Name of the vault/secrets manager", "required": false },
        { "name": "createdDate", "type": "string", "description": "Secret creation date", "required": true },
        { "name": "expirationDate", "type": "string", "description": "Secret expiration date", "required": false },
        { "name": "lastRotated", "type": "string", "description": "Last rotation date", "required": true },
        { "name": "rotationPolicyDays", "type": "number", "description": "Required rotation interval in days", "required": true },
        { "name": "fipsValidated", "type": "boolean", "description": "Whether using FIPS 140-2 validated module", "required": false },
        { "name": "accessRestrictedTo", "type": "array", "description": "List of services/users with access", "required": true }
      ],
      "complianceChecks": [
        { "check": "vault_storage", "rule": "storedInVault === true", "failMessage": "Secret not stored in approved vault-key management failure", "severity": "critical" },
        { "check": "algorithm_strength", "rule": "algorithm in ['AES-256', 'RSA-2048+', 'Ed25519', 'bcrypt', 'argon2']", "failMessage": "Weak or deprecated algorithm detected", "severity": "critical" },
        { "check": "rotation_compliance", "rule": "daysSinceLastRotation < rotationPolicyDays", "failMessage": "Secret overdue for rotation", "severity": "high" },
        { "check": "expiration", "rule": "daysUntilExpiration > 30", "failMessage": "Secret expiring within 30 days", "severity": "medium" },
        { "check": "fips_compliance", "rule": "if cmmc_scope then fipsValidated === true", "failMessage": "CMMC requires FIPS 140-2 validated cryptography", "severity": "critical" },
        { "check": "key_length", "rule": "keyLength >= 256 for symmetric or keyLength >= 2048 for asymmetric", "failMessage": "Key length below minimum requirement", "severity": "high" }
      ]
    },
    {
      "type": "CustomResource",
      "description": "A flexible resource type for organization-specific assets. Used when standard resource types don't fit. Maps to any compliance control based on custom evaluation logic.",
      "evaluationLogic": "Evaluate based on custom rules defined per instance. Custom resources allow organizations to extend the taxonomy for specialized infrastructure or application-specific compliance needs.",
      "applicableFrameworks": {
        "note": "Custom resources can map to any framework control based on organizational needs"
      },
      "properties": [
        { "name": "resourceId", "type": "string", "description": "Unique identifier", "required": true },
        { "name": "resourceName", "type": "string", "description": "Human-readable name", "required": true },
        { "name": "resourceCategory", "type": "string", "description": "Category: database, api, storage, network, application, container", "required": true },
        { "name": "environment", "type": "string", "description": "Environment: production, staging, development", "required": true },
        { "name": "owner", "type": "string", "description": "Resource owner", "required": true },
        { "name": "classification", "type": "string", "description": "Data classification: public, internal, confidential, restricted", "required": true },
        { "name": "complianceScope", "type": "array", "description": "Framework IDs this resource is in scope for", "required": true },
        { "name": "customProperties", "type": "object", "description": "Additional key-value properties for custom evaluation", "required": false },
        { "name": "lastAssessmentDate", "type": "string", "description": "Date of last compliance assessment", "required": true },
        { "name": "complianceStatus", "type": "string", "description": "compliant, non_compliant, partial, not_assessed", "required": true }
      ],
      "complianceChecks": [
        { "check": "classification_assigned", "rule": "classification !== null", "failMessage": "Resource not classified-required for scope determination", "severity": "high" },
        { "check": "owner_assigned", "rule": "owner !== null && owner !== ''", "failMessage": "Resource has no assigned owner", "severity": "medium" },
        { "check": "recent_assessment", "rule": "daysSinceLastAssessment < 365", "failMessage": "Resource not assessed within the past year", "severity": "medium" },
        { "check": "production_compliance", "rule": "if environment === 'production' then complianceStatus === 'compliant'", "failMessage": "Production resource not in compliant status", "severity": "critical" }
      ]
    }
  ]
}
